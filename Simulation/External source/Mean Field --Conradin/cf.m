function [Hcf]=cf()

% Below is the crystal field operator as
% reconstructed from the table VII in
% P.E. Hansen et al. PRB vol. 12 p. 5315 (1975)

% Energies are in Kelvin -> meV (1 meV=11.6 K)
%ecf=[535 492 398 92 74 546 546 497 497 124 124 0 0 575 511 39 9]/11.6;
ecf=[535 492 398 92 74 546 497 124 0 546 497 124 0 575 511 39 9]/11.6;

i=sqrt(-1);

cs1=[exp(1.7i*pi/180) 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
     0 0 0 0 exp(-i*8.2*pi/180) 0 0 0 0 0 0 0 0 0 0 0 0;...
     0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0;...
     0 0 0 0 0 0 0 0 0 0 0 0 exp(i*8.2*pi/180) 0 0 0 0;...
     0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 exp(-i*1.7*pi/180)];

cw1=[0.397 -.437 .551 -.437 .397;...
 .53 -.468 0 .468 -.530;...
-.386 .158 .807 .158 -.386;...
.468 .530 0 -.530 -.468;...
.440 .533 .212 .533 .440];

cs2a=[0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
      0 0 0 0 0 exp(-i*9.2*pi/180) 0 0 0 0 0 0 0 0 0 0 0;...
      0 0 0 0 0 0 0 0 0 exp(-i*88.1*pi/180) 0 0 0 0 0 0 0;...
      0 0 0 0 0 0 0 0 0 0 0 0 0 exp(-i*92.5*pi/180) 0 0 0];
cs2b=fliplr(conj(cs2a));

cw2=[.562 -.717 -.371 .183;...
     .281 -.305 .788 -.456;...
     .070 .023 .488 .870;...
     .775 .627 -.060 -.045];

cs3=[0 0 exp(i*30.4*pi/180) 0 0 0 0 0 0 0 0 0 0 0 0 0 0;...
     0 0 0 0 0 0 exp(i*22.7*pi/180) 0 0 0 0 0 0 0 0 0 0;...
     0 0 0 0 0 0 0 0 0 0 exp(-i*22.7*pi/180) 0 0 0 0 0 0;...
     0 0 0 0 0 0 0 0 0 0 0 0 0 0 exp(-i*30.4*pi/180) 0 0];

cw3=[.374 -.600 -.600 .374;...
     -.423 .566 -.566 .423;...
     .600 .374 .374 .600;...
     -.566 -.423 .423 .566];

cf=[cw1*cs1;cw2*cs2a;cw2*cs2b;cw3*cs3];

%Hcf=cf'*diag(ecf)*cf;

%----- Form the J operators

J=8;
Jz=diag(J:-1:-J);
Jp=diag(sqrt((J-[J-1:-1:-J]).*(J+1+[J-1:-1:-J])),1);
Jm=Jp';
Jx=(Jp+Jm)/2;
Jy=(Jp-Jm)/2i;

%----- Build Vcf from the stevens operators:

X=J*(J+1);
O20=3*Jz^2-X*eye(17);
O40=35*Jz^4-(30*X-25)*Jz^2+(3*X^2-6*X)*eye(17);
O44=(Jp^4+Jm^4)/2;
O60=231*Jz^6-(315*X-735)*Jz^4+(105*X^2-525*X+294)*Jz^2+(-5*X^3+40*X^2-60*X)*eye(17);
%Or64=(11*Jz^2-X-38)*Jp^4+Jp^4*(11*Jz^2-X-38);
%Or6m4=(11*Jz^2-X-38)*Jm^4+Jm^4*(11*Jz^2-X-38);
%O64c=sqrt( 1/2)*(Or64+Or6m4);
%O64s=sqrt(-1/2)*(Or6m4-Or64);

O64c=0.25*((11*Jz^2-X*eye(17)-38*eye(17))*(Jp^4+Jm^4)+(Jp^4+Jm^4)*(11*Jz^2-X*eye(17)-38*eye(17)));
O64s=-i*0.25*((11*Jz^2-X*eye(17)-38*eye(17))*(Jp^4-Jm^4)+(Jp^4-Jm^4)*(11*Jz^2-X*eye(17)-38*eye(17)));

% Parameters in meV according to JJ's note
B=[-60 0.35 3.6 0.0004 0.07 0.0098]/1000; % in meV
%B=[-64.8 .4258 4.5344 .0001003 .08553 .01688]/1000; % in meV

Hcf=B(1)*O20+B(2)*O40+B(3)*O44+B(4)*O60+B(5)*O64c+B(6)*O64s;
